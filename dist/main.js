!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const n=async e=>{const t=e.data.length/4;for(let a=0;a<t;a++){const t=4*a,n=(e.data[t]+e.data[t+1]+e.data[t+2])/3;e.data[t]=n,e.data[t+1]=n,e.data[t+2]=n}return e};n.toString=()=>"[JS] Greyscale";var r=n,i=(e,t=null)=>{const a=new Uint32Array(e);return t&&a.set(t),a},o=(e,{width:t,height:a})=>new ImageData(new Uint8ClampedArray(e),t,a);const s=async e=>{const{data:t}=e,a=i(t),n=t.length/4;for(let e=0;e<n;e++){const t=4*e,n=(a[t]+a[t+1]+a[t+2])/3;a[t]=n,a[t+1]=n,a[t+2]=n}return o(a,e)};s.toString=()=>"[JS] Greyscale - copy to buffer";var c=s;const l=async e=>{const{width:t,data:a}=e,n=4*t,r=a.length-4*t;for(let i=n;i<r;i+=4){let n=0,r=0,o=0;n=a[i]+a[i-4]+a[i+4]+a[i-4*t]+a[i-4*t-4]+a[i-4*t+4]+a[i+4*t-4]+a[i+4*t]+a[i+4*t+4],r=a[i+1]+a[i-3]+a[i+5]+a[i-4*t+1]+a[i-4*t-3]+a[i-4*t+5]+a[i+4*t-3]+a[i+4*t+1]+a[i+4*t+5],o=a[i+2]+a[i-2]+a[i+6]+a[i-4*t+2]+a[i-4*t-2]+a[i-4*t+6]+a[i+4*t-2]+a[i+4*t+2]+a[i+4*t+6],n/=9,r/=9,o/=9,e.data[i]=n,e.data[i+1]=r,e.data[i+2]=o}return e};l.toString=()=>"[JS] Mean filter";var d=l;const u=async e=>{const{width:t,data:a}=e,n=i(a),r=4*t,s=n.length-4*t;for(let e=r;e<s;e+=4){let a=0,r=0,i=0;a=n[e]+n[e-4]+n[e+4]+n[e-4*t]+n[e-4*t-4]+n[e-4*t+4]+n[e+4*t-4]+n[e+4*t]+n[e+4*t+4],r=n[e+1]+n[e-3]+n[e+5]+n[e-4*t+1]+n[e-4*t-3]+n[e-4*t+5]+n[e+4*t-3]+n[e+4*t+1]+n[e+4*t+5],i=n[e+2]+n[e-2]+n[e+6]+n[e-4*t+2]+n[e-4*t-2]+n[e-4*t+6]+n[e+4*t-2]+n[e+4*t+2]+n[e+4*t+6],a/=9,r/=9,i/=9,n[e]=a,n[e+1]=r,n[e+2]=i}return o(n,e)};u.toString=()=>"[JS] Mean filter - Copy to buffer";var f=u;const m=async e=>{const{data:t}=e;for(let e=0;e<t.length;e+=4){let a=t[e],n=t[e+1],r=t[e+2];a=Math.min(255,a+40),n=Math.min(255,n+20),t[e]=a,t[e+1]=n,t[e+2]=r}return e};m.toString=()=>"[JS] Sepia";var y=m;const p=async e=>{const{data:t}=e,a=i(t);for(let e=0;e<a.length;e+=4){let t=a[e],n=a[e+1],r=a[e+2];t=Math.min(255,t+40),n=Math.min(255,n+20),a[e]=t,a[e+1]=n,a[e+2]=r}return o(a,e)};p.toString=()=>"[JS] Sepia - copy to buffer";var g={greyscale:r,greyscaleBuffer:c,meanFilter:d,meanFilterBuffer:f,sepia:y,sepiaBuffer:p};const h={};var w=async(e,t)=>{if(e in h)return h[e];const a=await fetch(e),n=await a.arrayBuffer();return h[e]=await WebAssembly.instantiate(n,t),h[e]};let b=new WebAssembly.Memory({initial:75});const v=async e=>{const{data:t}=e,a=i(b.buffer,t),n={js:{memory:b}},{instance:r}=await w("./dist/greyscale.wasm",n);return r.exports.effect(0,t.length),o(a,e)};v.toString=()=>"[WAT] Greyscale";var S=v;let M=new WebAssembly.Memory({initial:75});const C=async e=>{const{data:t}=e,a=new Uint32Array(M.buffer);a.set(t);const n={js:{memory:M}},{instance:r}=await w("./dist/meanFilter.wasm",n);return r.exports.effect(0,t.length,e.width),new ImageData(new Uint8ClampedArray(a),e.width,e.height)};C.toString=()=>"[WAT] Mean filter";var j=C;let x=new WebAssembly.Memory({initial:75});const A=async e=>{const{data:t}=e,a=new Uint32Array(x.buffer);a.set(t);const n={js:{memory:x}},{instance:r}=await w("./dist/sepia.wasm",n);return r.exports.effect(0,t.length,20),new ImageData(new Uint8ClampedArray(a),e.width,e.height)};A.toString=()=>"[WAT] Sepia";var O={greyscale:S,meanFilter:j,sepia:A};const B={width:640,height:480},U=(e,t,a=t.toString())=>{let n=0,r=0;const i=document.createElement("canvas");Object.entries(B).map(([e,t])=>i[e]=t);const o=document.createElement("div");o.className="display",o.appendChild(document.createTextNode(a)),o.appendChild(i);const s=document.createElement("time");o.appendChild(s),document.querySelector("#displays").appendChild(o),((e,t,a,n)=>{const r=t.getContext("2d"),i={timerCallback:()=>{i.process(),setTimeout(()=>i.timerCallback(),1e3/60)},process:async()=>{r.drawImage(e,0,0,640,480);const t=r.getImageData(0,0,e.width,e.height),i=performance.now(),o=await a(t),s=performance.now()-i;n(s),r.putImageData(o,0,0)}};i.timerCallback()})(e,i,t,e=>{n+=e,r++,s.textContent=`xÌ„  = ${Math.round(n/r)} ms`})},E={greyscale:[g.greyscale,O.greyscale],greyscaleBuffer:[g.greyscaleBuffer,O.greyscale],sepia:[g.sepia,O.sepia],sepiaBuffer:[g.sepiaBuffer,O.sepia],mean:[g.meanFilter,O.meanFilter],meanBuffer:[g.meanFilterBuffer,O.meanFilter]};window.onload=()=>{(async()=>{const e=Object.keys(E)[0],t=document.querySelector("video");await(async e=>{if(!navigator.mediaDevices.getUserMedia)throw new Error("No camera available");e.srcObject=await navigator.mediaDevices.getUserMedia({video:!0})})(t),(()=>Object.keys(E).forEach(e=>{const t=document.createElement("li"),a=document.createElement("a");a.appendChild(document.createTextNode(e)),a.href=`?set=${e}`,t.appendChild(a),document.querySelector("#set-list").appendChild(t)}))(),E[((e=null)=>new URL(document.location).searchParams.get("set")||e)(e)].forEach(e=>U(t,e))})()}}]);